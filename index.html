<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Primitiva GB</title>
		<script src="phonegap.js"></script>
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
		<script type="text/javascript" src="http://www.google.com/jsapi"></script>
		
		<script>
			var URL='http://www.loteriasyapuestas.es/es/la-primitiva/resultados/.formatoRSS';
			google.load("feeds", "1");
			var Nums=[[],[12,34,23,45,34,23],[16,20,28,45,34,23],[16,20,28,40,34,23],[12,34,23,45,34,23],[02,44,49,34,23],[12,34,23,45,34,23],[12,34,23,45,34,23],[12,34,23,45,34,23]];
			var Resultats=[];
			
			function SetUp(){
				var feedpointer=new google.feeds.Feed(URL);
				feedpointer.setNumEntries(4);
				feedpointer.load(Loaded);

				function Loaded(result)
				{
					for	(x = 1; x < 3; x++)
					{
						GetInfo(result,x);
						VerificarPremio(x);
						MostrarDades(x);
					}

				}
			}
			
			function GetInfo(result,index){
				var Dades=result.feed.entries[index];
				Resultats[index]=[];
				Resultats[index][0]=Dades.title.split('del ')[1];
				for	(i = 0; i < 6; i++){Resultats[index][i + 1]=Dades.content.split('<p>')[2].split('<b>')[1].split('<')[0].split(' - ')[i]}
				Resultats[index][7]=Dades.content.split('<p>')[2].split('<b>')[3].split('(')[1].split(')')[0];
				Resultats[index][8]=Dades.content.split('<p>')[2].split('<b>')[2].split('(')[1].split(')')[0];
				for	(i = 10; i < 16; i++){Resultats[index][i]=0;}
			}
			
			function MostrarDades(index){
				var dades=Resultats[index];
				var Control='#N' + index;
				var Resultat="";
				
				$('body').append( "<div id='D" + index + "'></div>" );
				$('#D' + index).html(dades[0]);
				$('body').append( "<div id='I" + index + "'></div>" );
				
				for	(i = 1; i < 7; i++)
				{
				$('#I' + index).append("<input id='" + 'N' + index + i + "' type='text' >");
				$(Control + i).val(dades[i]);
				}
				
				$('#I' + index).append('C');
				$('#I' + index).append("<input id='C" + index + "' type='text' >");
				$('#C' + index).val(dades[7]);
				$('#I' + index).append('R');
				$('#I' + index).append("<input id='R" + index + "' type='text' >");
				$('#R' + index).val(dades[8]);
				$('#I' + index).append("<p id='S" + index + "'></p>");
				
				if (dades[15]==1)
				{
					for(iP=10;iP<14;iP++)
					{
						if (dades[iP]==1){Resultat=Resultat  + 'Una' + " apuesta de " + (iP - 7) + " aciertos " + '<br/>';}
						if (dades[iP]>=2){Resultat=Resultat  + dades[iP] + " apuestas de " + (iP - 7) +" aciertos " + '<br/>';}
					}
				}
				else { Resultat='SIN PREMIO...';}
				$('#S' + index).html(Resultat);
				
				$('body').append( "<br/>");
			}
			
			function VerificarPremio(index){
				var Ret;
				for	(iA = 1; iA < 9; iA++)
				{
					ret=Comprobar(index,iA)
					if (ret==3){Resultats[index][10]=Resultats[index][10] + 1;}
					if (ret==4){Resultats[index][11]=Resultats[index][11] + 1;}
					if (ret==5){Resultats[index][12]=Resultats[index][12] + 1;}
					if (ret==6){Resultats[index][13]=Resultats[index][13] + 1;}
					if (ret>2) {Resultats[index][15]=1;}
				}
				
			}
			
			function Comprobar(Dia,Apuesta){
				Aciertos=0;
				for	(iANum = 1; iANum < 7; iANum++)
				{
					for	(iRNum = 1; iRNum < 7; iRNum++)
						{
							if(Resultats[Dia][iRNum] == Nums[Apuesta][iANum - 1]) 
							{
								Aciertos=Aciertos + 1;
							}
						}
					
					
				}
				return Aciertos;	
			}
			
			window.onload=function(){SetUp();};
			
		</script>

		<style>
			input {width:20px;text-align:center;}
			div {text-align:center;}
		</style>
	</head>
	<body >
		
	</body>
</html>